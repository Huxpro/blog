
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->

<head>


<meta charset="utf-8">
<meta http-equiv="cleartype" content="on">

<title>Update Your Software: It&#8217;s the Law - Bits, Bytes, and Words</title>
<meta name="author" content="Jake Zimmerman">




<meta name="description" content="I wrote a short bash snippet to check my command line software for updates and alert me once a day.">

<meta name="keywords" content="best practices terminal unix ">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Twitter Cards -->


<!-- Open Graph -->
<meta property="og:local" content="en_US">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.jez.io/2014/06/11/update-your-software-its-the-law">
<meta property="og:title" content="Update Your Software: It's the Law">
<meta property="og:description" content="I wrote a short bash snippet to check my command line software for updates and alert me once a day.">

  <meta property="og:image" content="">

<meta property="og:site_name" content="Bits, Bytes, and Words">

<link rel="canonical" href="https://blog.jez.io/2014/06/11/update-your-software-its-the-law">
<link href="/favicon.png" rel="icon">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/atom.xml" rel="alternate" title="Bits, Bytes, and Words" type="application/atom+xml">

<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
<script>Modernizr || document.write('<script src="/javascripts/vendor/modernizr-2.6.2.custom.min.js"><\/script>') </script>




</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
  <button class="dl-trigger">Open Menu</button>
  <ul class="dl-menu">
    <li><a href="/">Home</a></li>
    <li><a href="/posts/">All Posts</a></li>
    <li><a href="/categories/">Posts by Category</a></li>
    <li><a href="https://jez.io">About Jake</a></li><li><a href="https://github.com/jez">GitHub</a></li>
  </ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title">Update Your Software: It&#8217;s the Law</h1>
        
        <h2>June 11, 2014</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Okay, so maybe the government won&rsquo;t come after you for not updating. But they should. To guard off any present or future threats (be they from governments, security vulnerabilities, or something else in the cyber realm), I wrote a short bash snippet to check my system for outdated packages.</p>

<!-- more -->


<h2>Obligatory Existential/Meta Section</h2>

<p>I don&rsquo;t quite know what prompted me to suddenly become interested in maintaining an up to date system. Maybe it was <a href="https://www.facebook.com/groups/cmuscs/permalink/727878180603546/">this post</a> of Arch Linux horror stories. Maybe it was the release of <a href="https://git.kernel.org/cgit/git/git.git/tree/Documentation/RelNotes/2.0.0.txt">git 2.0</a>, which introduces a lot of cool new features and deprecates a lot of others. Who knows, maybe it was influenced by Heartbleed and the <a href="https://www.openssl.org/news/secadv_20140605.txt">host</a> <a href="http://grahamcluley.com/2014/06/feedly-blackmail-ddos/">of other</a> <a href="http://blog.evernote.com/blog/2013/03/02/security-notice-service-wide-password-reset/">high-profile</a> security vulnerabilities and hacks that have sprung up lately. It&rsquo;s probably a combination of all of these. Let&rsquo;s move on.</p>

<p>For the impatient among us, here&rsquo;s the code, which is also available <a href="https://github.com/jez/dotfiles/blob/master/bash_profile#L16-L42">here</a> and <a href="https://github.com/jez/dotfiles/blob/master/bash_profile#L153-L178">here</a> amongst all the code for <a href="https://github.com/jez/dotfiles">all my dotfiles</a>.</p>

<figure class='code'><figcaption><span>Remind to update</span></figcaption><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># ----- daily updates --------------------------------------------------------</span>
</span><span class='line'><span class="o">[</span> ! -e <span class="nv">$HOME</span>/.last_update <span class="o">]</span> <span class="o">&amp;&amp;</span> touch <span class="nv">$HOME</span>/.last_update
</span><span class='line'><span class="c"># Initialize for when we have no GNU date available</span>
</span><span class='line'><span class="nv">last_check</span><span class="o">=</span>0
</span><span class='line'><span class="nv">time_now</span><span class="o">=</span>0
</span><span class='line'>
</span><span class='line'><span class="c"># Unix last command to check the log of logins, grab the most recent</span>
</span><span class='line'><span class="nv">last_check_string</span><span class="o">=</span><span class="sb">`</span>ls -l <span class="nv">$HOME</span>/.last_update | awk <span class="s1">'{print $6" "$7" "$8}'</span><span class="sb">`</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Darwin uses BSD, check for gdate, else use date</span>
</span><span class='line'><span class="k">if</span> <span class="o">[[</span> <span class="sb">`</span>uname<span class="sb">`</span> <span class="o">=</span> <span class="s2">"Darwin"</span> <span class="o">&amp;&amp;</span> -n <span class="sb">`</span>which gdate<span class="sb">`</span> <span class="o">]]</span>; <span class="k">then
</span><span class='line'>  </span><span class="nv">last_login</span><span class="o">=</span><span class="sb">`</span>gdate -d<span class="s2">"</span><span class="nv">$last_check_string</span><span class="s2">"</span> +%s<span class="sb">`</span>
</span><span class='line'>  <span class="nv">time_now</span><span class="o">=</span><span class="sb">`</span>gdate +%s<span class="sb">`</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="c"># Ensure this is GNU grep</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">[</span> -n <span class="s2">"</span><span class="sb">`</span>date --version 2&gt; /dev/null | grep GNU<span class="sb">`</span><span class="s2">"</span> <span class="o">]</span>; <span class="k">then
</span><span class='line'>    </span><span class="nv">last_login</span><span class="o">=</span><span class="sb">`</span>date -d<span class="s2">"</span><span class="nv">$last_login_string</span><span class="s2">"</span> +%s<span class="sb">`</span>
</span><span class='line'>    <span class="nv">time_now</span><span class="o">=</span><span class="sb">`</span>date +%s<span class="sb">`</span>
</span><span class='line'>  <span class="k">fi
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'></span><span class="nv">time_since_check</span><span class="o">=</span><span class="k">$((</span>time_now <span class="o">-</span> last_login<span class="k">))</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$time_since_check</span><span class="s2">"</span> -ge 86400 <span class="o">]</span>; <span class="k">then
</span><span class='line'>  </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$cred</span><span class="s2">==&gt;</span><span class="nv">$cwhiteb</span><span class="s2"> Your system is out of date!</span><span class="nv">$cnone</span><span class="s2">"</span>
</span><span class='line'>  <span class="nb">echo</span> <span class="s1">'Run `update` to bring it up to date.'</span>
</span><span class='line'><span class="k">fi</span></span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Check for updates</span></figcaption><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># ----- function -------------------------------------------------------------</span>
</span><span class='line'>update<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  touch <span class="nv">$HOME</span>/.last_update
</span><span class='line'>
</span><span class='line'>  <span class="c"># Mac updates</span>
</span><span class='line'>  <span class="k">case</span> <span class="nv">$HOSTNAME</span> <span class="k">in</span>
</span><span class='line'>    <span class="k">*</span>Jacobs-MacBook-Air<span class="k">*</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$cblueb</span><span class="s2">==&gt;</span><span class="nv">$cwhiteb</span><span class="s2"> Updating Homebrew...</span><span class="nv">$cnone</span><span class="s2">"</span>
</span><span class='line'>      brew update
</span><span class='line'>
</span><span class='line'>      <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$cblueb</span><span class="s2">==&gt;</span><span class="nv">$cwhiteb</span><span class="s2"> Checking for outdated brew packages...</span><span class="nv">$cnone</span><span class="s2">"</span>
</span><span class='line'>      brew outdated --verbose
</span><span class='line'>
</span><span class='line'>      <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$cblueb</span><span class="s2">==&gt;</span><span class="nv">$cwhiteb</span><span class="s2"> Checking for outdated rbenv...</span><span class="nv">$cnone</span><span class="s2">"</span>
</span><span class='line'>      <span class="nb">cd</span> <span class="nv">$HOME</span>/.rbenv
</span><span class='line'>      git fetch
</span><span class='line'>      <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="sb">`</span>git describe --tags master<span class="sb">`</span><span class="s2">"</span> !<span class="o">=</span> <span class="s2">"</span><span class="sb">`</span>git describe --tags origin/master<span class="sb">`</span><span class="s2">"</span> <span class="o">]</span>; <span class="k">then
</span><span class='line'>        </span><span class="nb">echo</span> <span class="s2">"rbenv (</span><span class="sb">`</span>git describe --tags master<span class="sb">`</span><span class="s2">) is outdated (</span><span class="sb">`</span>git describe --tags origin/master<span class="sb">`</span><span class="s2">)."</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="s2">"To update, run: cd ~/.rbenv; git merge origin master &amp;&amp; cd -"</span>
</span><span class='line'>      <span class="k">fi
</span><span class='line'>      </span><span class="nb">cd</span> - 2&gt;&amp;1 &gt; /dev/null
</span><span class='line'>
</span><span class='line'>      <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$cblueb</span><span class="s2">==&gt;</span><span class="nv">$cwhiteb</span><span class="s2"> Checking for outdated ruby gems...</span><span class="nv">$cnone</span><span class="s2">"</span>
</span><span class='line'>      gem outdated
</span><span class='line'>      <span class="p">;;</span>
</span><span class='line'>  <span class="k">esac</span>
</span><span class='line'><span class="o">}</span></span></code></pre></td></tr></table></div></figure>


<p>You&rsquo;ll note the use of a touch file (created in line 2 of the first snippet if it doesn&rsquo;t already exist). If this file is 24 hours old, each time this code is run an alert will be printed. Since this code is running inside of my <code>.bash_profile</code>, that means that every time I open a terminal on a 24-hour-old system, I see the update message.</p>

<p>Next, you&rsquo;ll note that I&rsquo;ve defined a function called <code>update</code> which is actually misnamed. This function merely checks for available updates instead of actually performing the updates, logging those packages, gems, and formulae it finds that are out of date. For my purposes, I only need to update brew, check for formulae updates, update rbenv, and check for gem updates. Obviously though, given that there is a way to programmatically check something for updates, plugging that code in here would check it as well. This means that this method is very easy to customize and extend for various needs.</p>

<h2>Rant</h2>

<p>I was planning on checking pip for updates as well, but pip is kind of not even good. To give you an idea, to check all the packages brew manages for updates, you type <code>brew outdated</code>, and it will list the formula name, current version number, and newest version number. Meanwhile, back in the land of pip, no such functionality exists (at least, simple functionality, and functionality that I could find. If you&rsquo;d like to correct me, be my guest!). I&rsquo;m sure that this script will grow as I come to manage more and more pieces of software on my system and others.</p>

<p>If you have any questions about what I&rsquo;ve done here, or you catch some bugs, be sure to comment below or file an issue on GitHub! I&rsquo;d love to hear what you have to say.</p>

<hr />

<p><br></p>

<h3>Jake on the Web</h3>

<p><a class="image-link" href="https://pbs.twimg.com/profile_images/463467877593407488/hfwJj20L.jpeg"><img class="left" src="https://pbs.twimg.com/profile_images/463467877593407488/hfwJj20L.jpeg" width="135" height="135"></a>
If you cared enough to read that far, you should consider following me on
<a href="https://www.github.com/jez/">GitHub</a> or paying a visit to <a href="https://jez.io/">my homepage</a>. If this post was about one of
my open source projects, make sure to star it on GitHub! I love hearing what
people think, so feel free to comment, open an issue, or send me an email.</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="/categories/#best practices" title="Pages tagged best practices" class="tag">best practices</a><a href="/categories/#terminal" title="Pages tagged terminal" class="tag">terminal</a><a href="/categories/#unix" title="Pages tagged unix" class="tag">unix</a></span>
        <span><a href="/2014/06/11/update-your-software-its-the-law/" rel="bookmark" title="Update Your Software: It's the Law">Update Your Software: It&#8217;s the Law</a> was published on <span class="entry-date date published updated"><time datetime="2014-06-11T22:22:57-04:00">June 11, 2014</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="https://jez.io" title="About Jake Zimmerman">Jake Zimmerman</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    
      <div class="read-more">
        
          <div class="read-more-header">
            <a href="/2016/08/03/vim-and-haskell-in-2016-on-os-x/" class="btn">Read More</a>
          </div><!-- /.read-more-header -->
          <div class="read-more-content">
            <h3><a href="/2016/08/03/vim-and-haskell-in-2016-on-os-x/" title="Vim and Haskell in 2016 on OS X">Vim and Haskell in 2016 on OS X</a></h3>
            <p>Stephen Diehl&#8217;s article &#8220;Vim and Haskell in 2016&#8221; does a great job of outlining the quickest way to get a quality Haskell development experience. His post presumes Ubuntu; here we presume OS X.
 <a href="/2016/08/03/vim-and-haskell-in-2016-on-os-x/"> Continue reading</a></p>
          </div><!-- /.read-more-content -->
        
        <div class="read-more-list">
          
            <div class="list-item">
              <h4><a href="/2016/04/17/lets-have-a-chat-about-encryption/" title="Let's Have a Chat about Encryption">Let&#8217;s Have a Chat about Encryption</a></h4>
              <span>Published on April 17, 2016</span>
            </div><!-- /.list-item -->
          
            <div class="list-item">
              <h4><a href="/2016/03/09/sml-dev-setup/" title="SML Dev Setup">SML Dev Setup</a></h4>
              <span>Published on March 09, 2016</span>
            </div><!-- /.list-item -->
          
        </div><!-- /.read-more-list -->
      </div><!-- /.read-more -->
    
    
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Jake Zimmerman. Powered by <a href="http://octopress.org">Octopress</a> using the <a href="https://github.com/jez/hpstr-theme/">HPSTR Theme for Octopress</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->


	        
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/javascripts/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/javascripts/scripts.min.js"></script>
&#8211;>
	        

</body>
</html>
